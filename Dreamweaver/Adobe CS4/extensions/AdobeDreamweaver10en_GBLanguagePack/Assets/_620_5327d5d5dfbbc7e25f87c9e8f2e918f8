<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--#config errmsg="" --><!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <meta name="lang" content="en-us" />
        <meta name="area" content="livedocs" />
        <title>Dreamweaver CS4 * Create a connection using a connection string</title>
        <meta name="product" content="$product" />
        <meta name="productv" content="" />
        <meta name="keywords" content="" />
        <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc78c5058ca073340dcda9110b1f693f21-7a11.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> 
<script type="text/javascript">
<!--[CDATA[
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
    var linkId = document.createElement("link");
    linkId.href = "content-ie6.css";
    linkId.rel = "stylesheet";
    linkId.type = "text/css";
    headId.appendChild(linkId);
}
// ]]-->
</script>
<!--#include virtual="/livedocs/ssi/globalheader.ssi" -->
        <link rel="stylesheet" type="text/css" href="tree.css" />
        <link rel="stylesheet" type="text/css" href="content-fonts.css" />
        <link rel="stylesheet" type="text/css" href="content-hyperlinks.css" />
        <link rel="stylesheet" type="text/css" href="content.css" />
        <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
    </head>
    <body id="content_body" onload="window.focus();">
        <a name="top"></a><div id="mnemonic">
            <div class="Dreamweaver"><table><tr><td class="banner">Dreamweaver CS4</td><td class="pod"><img src="images/PDF.gif" width="16" height="16" hspace="15" valign="50%" />&#160;&#160;
                     <a title="PDF" href="http://help.adobe.com/en_US/Dreamweaver/10.0_Using/dreamweaver_cs4_help.pdf">
                         PDF (adobe.com) 
                    </a></td></tr></table></div>
        </div>
        <div id="searchbar">
<!-- BEGIN SEARCH CONTENT -->
            <form class="search_form" id="search" name="search" action="search.html" target="_self">
                <img src="images/search.png" />
<script type="text/javascript">
<!--[CDATA[
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}
document.write('<input class=\"search_input\" \
        name=\"q\" \
        id=\"q\" \
        type=\"text\" \
        maxlength=\"256\" \
        value=\"' + terms_AHV_SEARCH_BUTTON + '\" onclick=\"clearSearch()\"><\/input>'); 
// ]]-->


</script> 
            </form>
        </div>
<!-- BEGIN PAGE CONTENT WRAPPER -->
        <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>
<td id="col1">
<!-- BEGIN IONCOMMENTCOUNT -->
            <div id="ionComCount">
            </div>
<!-- END IONCOMMENTCOUNT -->
<!-- BEGIN GROUP TOC WRAPPER -->
            <div id="group_toc"><p>Dreamweaver CS4 Resources</p><ul><li><p><a href="../../Dreamweaver/10.0/index.html" target="_blank">Using
Dreamweaver CS4</a></p>
</li><li><p><a href="http://help.adobe.com/en_US/Dreamweaver/10.0_Extending/index.html" target="_blank">Extending Dreamweaver CS4 (adobe.com)</a></p>
</li><li><p><a href="http://help.adobe.com/en_US/Dreamweaver/10.0_API_Ref/index.html" target="_blank">Dreamweaver API Reference (adobe.com)</a></p>
</li></ul></div>
<!-- END GROUP TOC WRAPPER -->
<!-- BEGIN NAV WRAPPER -->
            <div id="group_toc">
<script type="text/javascript">
<!--[CDATA[
if ( typeof(terms_BOOK_SHORT) != 'undefined' ) {
  document.write("<p>" + terms_BOOK_SHORT + "<\/p>");
}
// ]]-->


</script> 
            </div>
            <div id="nav_content">
            </div>
<!-- END NAV WRAPPER -->
</td>
<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->
            
            <div id="breadcrumb">
                
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc78c5058ca073340dcda9110b1f693f21-7a0d.html" title="Create a connection using a remote DSN"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc78c5058ca073340dcda9110b1f693f21-7a07.html" title="Edit or delete a database connection"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy"><a href="WSc78c5058ca073340dcda9110b1f693f21-7a31.html">Preparing to build dynamic sites</a> /
     <a href="WSc78c5058ca073340dcda9110b1f693f21-7a11.html"><b>Database connections for ASP developers</b></a> 
     </div>

            </div>
<!-- END BREADCRUMBS -->
            <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
                <h1>
                    Create a connection using a connection string
                </h1>
<!-- END PAGE TITLE -->
                <br clear="both" /><div id="minitoc"><div class="t"><div class="b"><div class="l"><div class="r"><div class="bl"><div class="br"><div class="tl"><div class="tr"><div><h3>Contents [<a href="#" onclick="return toggleMiniToc('minitoc-links', this);" class="hideLink">Hide</a>]</h3><ul id="minitoc-links"><li><p><a href="#WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E"><h4 class="topictitle4">Connecting to a database on an ISP</h4>
</a></p></li><li><p><a href="#WS134982D7-91C4-4831-926F-AA34ED294BF0"><h4 class="topictitle4">Understanding physical and virtual paths</h4>
</a></p></li><li><p><a href="#WS99AC032B-F852-490b-83F2-05E79C363F6B"><h4 class="topictitle4">Find a file’s physical path with the virtual path</h4>
</a></p></li><li><p><a href="#WSE46A9841-5A25-4bb1-9AAA-D480FB635D36"><h4 class="topictitle4">Use a virtual path to connect to a database</h4>
</a></p></li></ul></div></div><br clear="both" /></div></div></div></div></div></div></div></div><br clear="both" /><div><div class="section"><p>You can use a DSN-less connection
to create an ODBC or OLE DB connection between your web application
and your database. You use a connection string to create this kind
of connection. </p>
</div>
<ol><li class="stepexpand"><span>Open an ASP page in Dreamweaver,
and then open the Databases panel (Window&#160;&gt; Databases).</span></li>
<li class="stepexpand"><span>Click the Plus (+) button on the panel, select Custom
Connection String from the menu, complete the options, and click
OK.</span></li>
<li class="stepexpand"><span>Enter a name for the new connection without spaces or
special characters.</span></li>
<li class="stepexpand"><span>Enter a connection string to the database. If you do
not specify an OLE DB provider in the connection string—that is,
if you don’t include a <samp class="codeph">Provider</samp> parameter—ASP will
automatically use the OLE DB provider for ODBC drivers. In that
case, you must specify an appropriate ODBC driver for your database.</span> <p>If your site is hosted by an ISP and you don’t know the
full path to your database, use the <samp class="codeph">MapPath</samp> method
of the ASP server object in your connection string.</p>
</li>
<li class="stepexpand"><span>If the database driver specified in the connection string
is not installed on the same computer as Dreamweaver,
select Using Driver On Testing Server.</span> <div class="note"><span class="notetitle">Note:  </span>Macintosh users can ignore this step because all database
connections use the application server.</div>
</li>
<li class="stepexpand"><span>You can restrict the number of database items Dreamweaver retrieves at design time by clicking
Advanced and entering a schema or catalog name.</span> <div class="note"><span class="notetitle">Note:  </span>You cannot create a schema or catalog in Microsoft Access.</div>
</li>
<li class="stepexpand"><span>Click Test to connect to the database, and then click
OK. If the connection fails, double‑check the connection string
or check the settings for the testing folder Dreamweaver uses to process dynamic pages.</span></li>
</ol>
</div>
<div id="WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E" class="nochunk"><a name="WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E"></a><h3 class="topictitle3">Connecting to a database on an ISP</h3><div><div class="section"><p>If
you’re an ASP developer working with a commercial Internet service
provider (ISP), you often don’t know the physical path of the files
you upload, including your database file or files. </p>
<p>If your
ISP doesn’t define a DSN for you or is slow to do so, you must find
another way to create the connections to your database files. One
alternative is to create a DSN-less connection to a database file,
but you can define such a connection only if you know the physical
path of the database file on the ISP server.</p>
<p>You can obtain
the physical path of a database file on a server by using the <samp class="codeph">MapPath</samp> method
of the ASP server object.</p>
<div class="note"><span class="notetitle">Note:  </span>The techniques discussed in this
section apply only if your database is file-based, such as a Microsoft
Access database where data is stored in an .mdb file.</div>
</div>
</div></div>
<div id="WS134982D7-91C4-4831-926F-AA34ED294BF0" class="nochunk"><a name="WS134982D7-91C4-4831-926F-AA34ED294BF0"></a><h3 class="topictitle3">Understanding physical and virtual paths</h3><div><div class="section"><p>After
using Dreamweaver to upload your files to
a remote server, the files reside in a folder in the server’s local
directory tree. For example, on a server running Microsoft IIS,
the path to your home page could be as follows:</p>
<pre>c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm</pre>
<p>This
path is known as the physical path to your file. </p>
<p>The URL
to open your file, however, does not use the physical path. It uses
the name of the server or domain followed by a virtual path, as
in the following example:</p>
<pre>www.plutoserve.com/jsmith/index.htm</pre>
<p>The
virtual path, /jsmith/index.htm, stands in for the physical path, c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm. </p>
</div>
</div></div>
<div id="WS99AC032B-F852-490b-83F2-05E79C363F6B" class="nochunk"><a name="WS99AC032B-F852-490b-83F2-05E79C363F6B"></a><h3 class="topictitle3">Find a file’s physical path with the virtual path</h3><div><div class="section"><p>If you work with an ISP, you don’t always
know the physical path to the files you upload. ISPs typically provide
you with an FTP host, possibly a host directory, and a login name
and password. ISPs also specify a URL to view your pages on the Internet,
such as www.plutoserve.com/jsmith/.</p>
<p>If you know the URL, then
you can get the file’s virtual path—it’s the path that follows the
server or domain name in a URL. Once you know the virtual path,
you can get the file’s physical path on the server using the <samp class="codeph">MapPath</samp> method.</p>
<p>The <samp class="codeph">MapPath</samp> method
takes the virtual path as an argument and returns the file’s physical
path and filename. Here’s the method’s syntax:</p>
<pre>Server.MapPath("<var class="varname">/virtualpath</var>")</pre>
<p>If
a file’s virtual path is /jsmith/index.htm, then the following expression
returns its physical path:</p>
<pre>Server.MapPath("/jsmith/index.htm")</pre>
<p>You
can experiment with the <samp class="codeph">MapPath</samp> method as follows. </p>
</div>
<ol><li class="stepexpand"><span>Open an ASP page in Dreamweaver and
switch to Code view (View&#160;&gt; Code).</span></li>
<li class="stepexpand"><span>Enter the following expression in the page’s HTML code.</span> <pre>&lt;%Response.Write(<var class="varname">stringvariable</var>)%&gt;</pre>
</li>
<li class="stepexpand"><span>Use the <samp class="codeph">MapPath</samp> method to obtain a value
for the <samp class="codeph"><var class="varname">stringvariable</var></samp> argument. </span> <p>Here’s an example:</p>
<pre>&lt;% Response.Write(Server.MapPath("/jsmith/index.htm")) %&gt;</pre>
</li>
<li class="stepexpand"><span>Switch to Design view (View&#160;&gt; Design) and
enable Live Data (View&#160;&gt; Live Data) to view the page.</span> <p>The page displays the physical path of the file on the
application server, for example:</p>
<pre>c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm</pre>
<p>For
more information on the <samp class="codeph">MapPath</samp> method, consult
the online documentation that comes with Microsoft IIS. </p>
</li>
</ol>
</div></div>
<div id="WSE46A9841-5A25-4bb1-9AAA-D480FB635D36" class="nochunk"><a name="WSE46A9841-5A25-4bb1-9AAA-D480FB635D36"></a><h3 class="topictitle3">Use a virtual path to connect to a database</h3><div><div class="section"><p>To write a DSN-less connection string to a
database file located on a remote server, you must know the physical
path to the file. The following example is a typical DSN-less connection
string for a Microsoft Access database:</p>
<pre>Driver={Microsoft Access Driver (*.mdb)}; 
DBQ=c:\Inetpub\wwwroot\accounts\users\jsmith\data\statistics.mdb</pre>
<p>If
you don’t know the physical path of your files on the remote server,
you can get the path by using the <samp class="codeph">MapPath</samp> method
in your connection string.</p>
</div>
<ol><li class="stepexpand"><span>Upload the database file to the remote server
and make a note of its virtual path—for example, /jsmith/data/statistics.mdb.</span></li>
<li class="stepexpand"><span>Open an ASP page in Dreamweaver,
then open the Databases panel (Window&#160;&gt; Databases).</span></li>
<li class="stepexpand"><span>Click the Plus (+) button on the panel and select Custom
Connection String from the menu.</span></li>
<li class="stepexpand"><span>Enter a name for the new connection, without spaces or
special characters.</span></li>
<li class="stepexpand"><span>Enter the connection string and use the <samp class="codeph">MapPath</samp> method
to supply the DBQ parameter.</span> <p>Suppose that the virtual path to your Microsoft Access
database is /jsmith/data/statistics.mdb; the connection string can
be expressed as follows if you use VBScript as your scripting language:</p>
<pre>“Driver={Microsoft Access Driver (*.mdb)};DBQ=” &amp; Server.MapPath¬ 
("/jsmith/data/statistics.mdb")</pre>
<p>The ampersand (&amp;)
is used to concatenate (combine) two strings. The first string is
enclosed in quotation marks and the second is returned by the <samp class="codeph">Server.MapPath</samp> expression.
When the two strings are combined, the following string is created:</p>
<pre>Driver={Microsoft Access Driver (*.mdb)}; 
DBQ=C:\Inetpub\wwwroot\accounts\users\jsmith\data\statistics.mdb</pre>
<p>If
you use JavaScript, the expression is identical except that you
use a Plus (+) sign instead of an ampersand (&amp;) to concatenate
the two strings:</p>
<pre>“Driver={Microsoft Access Driver (*.mdb)};DBQ=” + Server.MapPath¬ 
("/jsmith/data/statistics.mdb")</pre>
</li>
<li class="stepexpand"><span>Select Using Driver On Testing Server, click Test, and
then click OK.</span> <div class="note"><span class="notetitle">Note:  </span>Macintosh users can ignore this step because all database
connections use the application server.</div>
 <div class="note"><span class="notetitle">Note:  </span>If the connection fails, double-check the connection
string or contact your ISP to make sure that the database driver
you specified in the connection string is installed on the remote
server. Also check that the ISP has the most recent version of the
driver. For example, a database created in Microsoft Access 2000
will not work with Microsoft Access Driver 3.5. You need Microsoft
Access Driver 4.0 or later.</div>
</li>
<li class="stepexpand"><span>Update the database connection of existing dynamic pages
(open the page in Dreamweaver, double-click
the recordset name in the Bindings panel or Server Behaviors panel,
and select the connection you just created from the Connection menu)
and use the new connection with any new page you build. </span></li>
</ol>
</div></div>

                <div id="related">
                    <div class="separator">&#160;</div>
                    <div><p>&#160;<a href="WSc78c5058ca073340dcda9110b1f693f21-7a20.html">Connecting to a ColdFusion database</a></p><p>&#160;<a href="WSc78c5058ca073340dcda9110b1f693f21-79b9a.html">Restrict database information displayed in Dreamweaver</a></p><p>&#160;<a href="WSc78c5058ca073340dcda9110b1f693f21-79f1.html">Troubleshooting database connections</a></p>
</div>
                    
                </div>
                <div id="footer">
                    <p><img src="images/Community.png" />&#160;<a title="community help (adobe.com)" href="http://www.adobe.com/go/lr_Dreamweaver_community_en">community help (adobe.com)</a></p>
<!-- BEGIN IONCOMMENTS -->
                    <div id="ionComHere">
                    </div>
<!-- END IONCOMMENTS -->
<!--#include virtual="ionComments.ssi" -->
                    <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a></p>
                </div>
            </div>
<!-- END CONTENT WRAPPER -->
</td>
</tr>
</table>
        </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--#include virtual="/livedocs/ssi/globalfooter.ssi" -->
<!--#include virtual="/ubi/analytics/analytics_ssi.html" -->
    </body>
</html>