<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--#config errmsg="" --><!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="es-es">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <meta name="lang" content="es-es" />
        <meta name="area" content="livedocs" />
        <title>Dreamweaver CS4 * Creación de una conexión utilizando una cadena de conexión</title>
        <meta name="product" content="$product" />
        <meta name="productv" content="" />
        <meta name="keywords" content="" />
        <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc78c5058ca073340dcda9110b1f693f21-7a11.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> 
<script type="text/javascript">
<!--[CDATA[
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
    var linkId = document.createElement("link");
    linkId.href = "content-ie6.css";
    linkId.rel = "stylesheet";
    linkId.type = "text/css";
    headId.appendChild(linkId);
}
// ]]-->
</script>
<!--#include virtual="/livedocs/ssi/globalheader.ssi" -->
        <link rel="stylesheet" type="text/css" href="tree.css" />
        <link rel="stylesheet" type="text/css" href="content-fonts.css" />
        <link rel="stylesheet" type="text/css" href="content-hyperlinks.css" />
        <link rel="stylesheet" type="text/css" href="content.css" />
        <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
    </head>
    <body id="content_body" onload="window.focus();">
        <a name="top"></a><div id="mnemonic">
            <div class="Dreamweaver"><table><tr><td class="banner">Dreamweaver CS4</td><td class="pod"><img src="images/PDF.gif" width="16" height="16" hspace="15" valign="50%" />&#160;&#160;
                     <a title="PDF" href="http://help.adobe.com/es_ES/Dreamweaver/10.0_Using/dreamweaver_cs4_help.pdf">
                         PDF (adobe.com) 
                    </a></td></tr></table></div>
        </div>
        <div id="searchbar">
<!-- BEGIN SEARCH CONTENT -->
            <form class="search_form" id="search" name="search" action="search.html" target="_self">
                <img src="images/search.png" />
<script type="text/javascript">
<!--[CDATA[
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}
document.write('<input class=\"search_input\" \
        name=\"q\" \
        id=\"q\" \
        type=\"text\" \
        maxlength=\"256\" \
        value=\"' + terms_AHV_SEARCH_BUTTON + '\" onclick=\"clearSearch()\"><\/input>'); 
// ]]-->


</script> 
            </form>
        </div>
<!-- BEGIN PAGE CONTENT WRAPPER -->
        <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>
<td id="col1">
<!-- BEGIN IONCOMMENTCOUNT -->
            <div id="ionComCount">
            </div>
<!-- END IONCOMMENTCOUNT -->
<!-- BEGIN GROUP TOC WRAPPER -->
            <div id="group_toc"><p>Recursos de Dreamweaver CS4</p><ul><li><p><a href="../../Dreamweaver/10.0/index.html" target="_blank">Uso de Dreamweaver CS4</a></p>
</li><li><p><a href="http://help.adobe.com/es_ES/Dreamweaver/10.0_Extending/index.html" target="_blank">Ampliación de Dreamweaver CS4 (adobe.com)</a></p>
</li><li><p><a href="http://help.adobe.com/es_ES/Dreamweaver/10.0_API_Ref/index.html" target="_blank">Referencia API de Dreamweaver (adobe.com)</a></p>
</li></ul></div>
<!-- END GROUP TOC WRAPPER -->
<!-- BEGIN NAV WRAPPER -->
            <div id="group_toc">
<script type="text/javascript">
<!--[CDATA[
if ( typeof(terms_BOOK_SHORT) != 'undefined' ) {
  document.write("<p>" + terms_BOOK_SHORT + "<\/p>");
}
// ]]-->


</script> 
            </div>
            <div id="nav_content">
            </div>
<!-- END NAV WRAPPER -->
</td>
<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->
            
            <div id="breadcrumb">
                
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc78c5058ca073340dcda9110b1f693f21-7a0d.html" title="Creación de una conexión utilizando un DSN remoto"><img src="images/blank.gif" alt="Anterior" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc78c5058ca073340dcda9110b1f693f21-7a07.html" title="Edición o eliminación de una conexión de base de datos"><img src="images/blank.gif" alt="Siguiente" width="17" height="17" /></a></li></ul><div class="hierarchy"><a href="WSc78c5058ca073340dcda9110b1f693f21-7a31.html">Preparación para crear sitios dinámicos</a> /
     <a href="WSc78c5058ca073340dcda9110b1f693f21-7a11.html"><b>Conexiones de base de datos para desarrolladores de ASP</b></a> 
     </div>

            </div>
<!-- END BREADCRUMBS -->
            <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
                <h1>
                    Creación de una conexión utilizando una cadena de conexión
                </h1>
<!-- END PAGE TITLE -->
                <br clear="both" /><div id="minitoc"><div class="t"><div class="b"><div class="l"><div class="r"><div class="bl"><div class="br"><div class="tl"><div class="tr"><div><h3>Contenido [<a href="#" onclick="return toggleMiniToc('minitoc-links', this);" class="hideLink">Ocultar</a>]</h3><ul id="minitoc-links"><li><p><a href="#WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E"><h4 class="topictitle4">Conexión con una base de datos en un ISP</h4>
</a></p></li><li><p><a href="#WS134982D7-91C4-4831-926F-AA34ED294BF0"><h4 class="topictitle4">Aspectos básicos de las rutas físicas y virtuales</h4>
</a></p></li><li><p><a href="#WS99AC032B-F852-490b-83F2-05E79C363F6B"><h4 class="topictitle4">Localización de una ruta física de archivo con la ruta virtual</h4>
</a></p></li><li><p><a href="#WSE46A9841-5A25-4bb1-9AAA-D480FB635D36"><h4 class="topictitle4">Utilización de una ruta virtual para conectar con una base de datos</h4>
</a></p></li></ul></div></div><br clear="both" /></div></div></div></div></div></div></div></div><br clear="both" /><div><div class="section"><p>Puede utilizar una conexión sin DSN para crear una conexión ODBC u OLE DB entre la aplicación Web y la base de datos.  Utilice una cadena de conexión para crear esta clase de conexión. </p>
</div>
<ol><li class="stepexpand"><span>Abra cualquier página de ASP en Dreamweaver y, a continuación, abra el panel Bases de datos (Ventana&#160;&gt; Bases de datos).</span></li>
<li class="stepexpand"><span>Haga clic en el botón de signo más (+) del panel y seleccione Cadena de conexión personalizada en el menú, rellene las opciones y haga clic en Aceptar.</span></li>
<li class="stepexpand"><span>Introduzca un nombre para la nueva conexión, sin espacios ni caracteres especiales.</span></li>
<li class="stepexpand"><span>Introduzca una cadena de conexión con la base de datos.  Si no especifica un proveedor OLE DB en la cadena de conexión (es decir, si no incluye un parámetro <samp class="codeph">Provider</samp> o de proveedor) ASP utilizará automáticamente el proveedor OLE DB para controladores ODBC. En dicho caso, deberá especificar un controlador ODBC adecuado para la base de datos.</span> <p>Si el servidor en el que se encuentra el sitio es de un ISP y desconoce la ruta completa de la base de datos, utilice el método <samp class="codeph">MapPath</samp> del objeto de servidor ASP en la cadena de conexión.</p>
</li>
<li class="stepexpand"><span>Si el controlador de base de datos especificado en la cadena de conexión no está instalado en el mismo equipo que Dreamweaver, seleccione Utilizando un controlador del servidor de prueba.</span> <div class="note"><span class="notetitle">Nota:  </span>Los usuarios de Macintosh pueden omitir este paso ya que todas las conexiones de base de datos utilizan el servidor de aplicaciones.</div>
</li>
<li class="stepexpand"><span>Puede restringir el número de elementos de la base de datos que puede recuperar Dreamweaver en tiempo de diseño haciendo clic en Avanzada e introduciendo un esquema o nombre de catálogo.</span> <div class="note"><span class="notetitle">Nota:  </span>No puede crear un esquema o catálogo en Microsoft Access.</div>
</li>
<li class="stepexpand"><span>Haga clic en Prueba para conectar con la base de datos y haga clic en Aceptar.  Si la conexión falla, compruebe la cadena de conexión o la configuración de la carpeta de prueba que utiliza Dreamweaver para procesar las páginas dinámicas.</span></li>
</ol>
</div>
<div id="WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E" class="nochunk"><a name="WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E"></a><h3 class="topictitle3">Conexión con una base de datos en un ISP</h3><div><div class="section"><p>Si usted es un desarrollador de ASP que trabaja con un ISP (Proveedor de servicios de Internet, Internet Service Provider), es probable que desconozca la ruta física de los archivos que carga, incluyendo el archivo o archivos de base de datos. </p>
<p>Si el ISP no define un DSN para usted o tarda en hacerlo, debe encontrar una forma alternativa de crear las conexiones con los archivos de base de datos.  Una alternativa es crear una conexión sin DSN con un archivo de base de datos, pero dicha conexión sólo puede definirse si conoce la ruta física del archivo de base de datos en el servidor del ISP.</p>
<p>Puede obtener la ruta física de un archivo de base de datos en un servidor utilizando el método <samp class="codeph">MapPath</samp> del objeto de servidor ASP.</p>
<div class="note"><span class="notetitle">Nota:  </span>Las técnicas que se describen en esta sección son aplicables sólo si la base de datos está basada en archivos, como la base de datos Microsoft Access, donde los datos se almacenan en un archivo .mdb.</div>
</div>
</div></div>
<div id="WS134982D7-91C4-4831-926F-AA34ED294BF0" class="nochunk"><a name="WS134982D7-91C4-4831-926F-AA34ED294BF0"></a><h3 class="topictitle3">Aspectos básicos de las rutas físicas y virtuales</h3><div><div class="section"><p>Después de cargar los archivos en un servidor remoto mediante Dreamweaver, los archivos residen en una carpeta en el árbol local de directorios del servidor.  Por ejemplo, en un servidor que ejecute Microsoft IIS, la ruta de la página principal podría ser la siguiente:</p>
<pre>c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm</pre>
<p>Esta ruta se conoce como la ruta física del archivo. </p>
<p>No obstante, el URL para abrir el archivo no utiliza la ruta física.  Utiliza el nombre del servidor o dominio seguido de una ruta virtual, como en el siguiente ejemplo:</p>
<pre>www.plutoserve.com/jsmith/index.htm</pre>
<p>La ruta virtual, /jsmith/index.htm, sustituye a la ruta física, c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm. </p>
</div>
</div></div>
<div id="WS99AC032B-F852-490b-83F2-05E79C363F6B" class="nochunk"><a name="WS99AC032B-F852-490b-83F2-05E79C363F6B"></a><h3 class="topictitle3">Localización de una ruta física de archivo con la ruta virtual</h3><div><div class="section"><p>Si trabaja con un ISP, no siempre conocerá la ruta física de los archivos que cargue.  Los ISP suelen proporcionarle un servidor FTP, posiblemente un directorio de servidor y un nombre de conexión y la contraseña.  Los ISP también especifican un URL para ver las páginas en Internet, como por ejemplo www.plutoserve.com/jsmith/.</p>
<p>Si conoce el URL, puede obtener la ruta virtual del archivo (es la ruta que sigue al nombre de servidor o de dominio en un URL).  Una vez conoce la ruta virtual, puede obtener la ruta física del archivo en el servidor mediante el método <samp class="codeph">MapPath</samp>.</p>
<p>El método <samp class="codeph">MapPath</samp> toma la ruta virtual como un argumento y devuelve la ruta física y el nombre del archivo.  He aquí la sintaxis del método:</p>
<pre>Server.MapPath("<var class="varname">/virtualpath</var>")</pre>
<p>Si /jsmith/index.htm es la ruta virtual de un archivo, la siguiente expresión devolverá su ruta física:</p>
<pre>Server.MapPath("/jsmith/index.htm")</pre>
<p>Puede experimentar con el método  <samp class="codeph">MapPath</samp> como se explica a continuación.  </p>
</div>
<ol><li class="stepexpand"><span>Abra una página ASP en Dreamweaver y cambie a la vista Código (Ver&#160;&gt; Código).</span></li>
<li class="stepexpand"><span>Introduzca la siguiente expresión en el código de la página HTML.</span> <pre>&lt;%Response.Write(<var class="varname">stringvariable</var>)%&gt;</pre>
</li>
<li class="stepexpand"><span>Utilice el método <samp class="codeph">MapPath</samp> para obtener un valor para el argumento <samp class="codeph"><var class="varname">stringvariable</var></samp>. </span> <p>A continuación se incluye un ejemplo:</p>
<pre>&lt;% Response.Write(Server.MapPath("/jsmith/index.htm")) %&gt;</pre>
</li>
<li class="stepexpand"><span>Cambie a la vista Diseño (Ver &gt; Diseño) y active Live Data (Ver &gt; Live Data) para ver la&#160;página.</span> <p>La página muestra la ruta física del archivo en el servidor de aplicaciones, por ejemplo:</p>
<pre>c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm</pre>
<p>Para más información sobre el método  <samp class="codeph">MapPath</samp>, consulte la documentación en línea que se suministra con Microsoft IIS. </p>
</li>
</ol>
</div></div>
<div id="WSE46A9841-5A25-4bb1-9AAA-D480FB635D36" class="nochunk"><a name="WSE46A9841-5A25-4bb1-9AAA-D480FB635D36"></a><h3 class="topictitle3">Utilización de una ruta virtual para conectar con una base de datos</h3><div><div class="section"><p>Para escribir una cadena de conexión sin DSN en un archivo de base de datos situado en un servidor remoto, debe conocer la ruta física del archivo.  El siguiente ejemplo es una cadena de conexión sin DSN típica para una base de datos Microsoft Access:</p>
<pre>Driver={Microsoft Access Driver (*.mdb)}; 
DBQ=c:\Inetpub\wwwroot\accounts\users\jsmith\data\statistics.mdb</pre>
<p>Si no conoce la ruta física de sus archivos en el servidor remoto, puede obtener la ruta utilizando el método  <samp class="codeph">MapPath</samp> de su cadena de conexión.</p>
</div>
<ol><li class="stepexpand"><span>Cargue el archivo de base de datos en el servidor remoto y anote su ruta virtual, como por ejemplo /jsmith/data/statistics.mdb.</span></li>
<li class="stepexpand"><span>Abra una página ASP en Dreamweaver y, a continuación, abra el panel Bases de datos (Ventana&#160;&gt; Bases de datos).</span></li>
<li class="stepexpand"><span>Haga clic en el botón del signo más (+) del panel y seleccione Cadena de conexión personalizada en el menú.</span></li>
<li class="stepexpand"><span>Introduzca un nombre para la nueva conexión, sin espacios ni caracteres especiales.</span></li>
<li class="stepexpand"><span>Introduzca la cadena de conexión y utilice el método  <samp class="codeph">MapPath</samp> para suministrar el parámetro DBQ.</span> <p>Suponga que la ruta virtual de su base de datos Microsoft Access es /jsmith/data/statistics.mdb; la cadena de conexión puede expresarse como se indica a continuación si utiliza el lenguaje de scripts VBScript:</p>
<pre>"Driver={Microsoft Access Driver (*.mdb)};DBQ=" &amp; Server.MapPath¬ 
("/jsmith/data/statistics.mdb")</pre>
<p>El carácter ampersand (&amp;) se utiliza para concatenar (combinar) dos cadenas.  La primera cadena va entre comillas y la segunda la devuelve la expresión <samp class="codeph">Server.MapPath</samp>.  Al combinar dos cadenas, se crea la siguiente cadena:</p>
<pre>Driver={Microsoft Access Driver (*.mdb)}; 
DBQ=C:\Inetpub\wwwroot\accounts\users\jsmith\data\statistics.mdb</pre>
<p>Si utiliza código JavaScript, la expresión es idéntica, salvo que el signo que se utiliza para concatenar dos cadenas es el más (+) en lugar del ampersand (&amp;):</p>
<pre>"Driver={Microsoft Access Driver (*.mdb)};DBQ=" + Server.MapPath¬ 
("/jsmith/data/statistics.mdb")</pre>
</li>
<li class="stepexpand"><span>Seleccione Utilizando un controlador del servidor de prueba, haga clic en Prueba y haga clic en Aceptar.</span> <div class="note"><span class="notetitle">Nota:  </span>Los usuarios de Macintosh pueden omitir este paso ya que todas las conexiones de base de datos utilizan el servidor de aplicaciones.</div>
 <div class="note"><span class="notetitle">Nota:  </span>Si la conexión falla, compruebe de nuevo la cadena de conexión o póngase en contacto con el ISP para asegurarse de que el controlador de base de datos que ha especificado en la cadena de conexión está instalado en el servidor remoto.  Compruebe asimismo que el ISP tiene la versión más reciente del controlador.  Por ejemplo, una base de datos creada en Microsoft Access 2000 no funciona con Microsoft Access Driver 3.5. Necesita Microsoft Access Driver 4.0 o una versión posterior.</div>
</li>
<li class="stepexpand"><span>Actualice la conexión de base de datos de las páginas dinámicas existentes (abra la página en Dreamweaver, haga doble clic en el nombre del juego de registros en el panel Vinculaciones o en el panel Comportamientos del servidor y seleccione la conexión que acaba de crear del menú Conexión) y utilice la nueva conexión con las páginas que cree. </span></li>
</ol>
</div></div>

                <div id="related">
                    <div class="separator">&#160;</div>
                    <div><p><a href="WSc78c5058ca073340dcda9110b1f693f21-7a20.html">Conexión con una base de datos de ColdFusion</a></p><p><a href="WSc78c5058ca073340dcda9110b1f693f21-79b9a.html">Restricción de la información de base de datos que se muestra en Dreamweaver</a></p><p><a href="WSc78c5058ca073340dcda9110b1f693f21-79f1.html">Solución de problemas de conexiones de base de datos</a></p>
</div>
                    
                </div>
                <div id="footer">
                    <p><img src="images/Community.png" />&#160;<a title="ayuda de comunidad (adobe.com)" href="http://www.adobe.com/go/lr_Dreamweaver_community_es">ayuda de comunidad (adobe.com)</a></p>
<!-- BEGIN IONCOMMENTS -->
                    <div id="ionComHere">
                    </div>
<!-- END IONCOMMENTS -->
<!--#include virtual="ionComments.ssi" -->
                    <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="Esta obra obtiene su licencia de una licencia de Atribución-No Comercial-Licenciar Igual 3.0 Unported" /></a></p>
                </div>
            </div>
<!-- END CONTENT WRAPPER -->
</td>
</tr>
</table>
        </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--#include virtual="/livedocs/ssi/globalfooter.ssi" -->
<!--#include virtual="/ubi/analytics/analytics_ssi.html" -->
    </body>
</html>