<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--#config errmsg="" --><!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="fr-fr">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <meta name="lang" content="fr-fr" />
        <meta name="area" content="livedocs" />
        <title>Dreamweaver CS4 * Modification d'une base de données à l'aide des commandes ASP</title>
        <meta name="product" content="$product" />
        <meta name="productv" content="" />
        <meta name="keywords" content="" />
        <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WScbb6b82af5544594822510a94ae8d65-788ca.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> 
<script type="text/javascript">
<!--[CDATA[
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
    var linkId = document.createElement("link");
    linkId.href = "content-ie6.css";
    linkId.rel = "stylesheet";
    linkId.type = "text/css";
    headId.appendChild(linkId);
}
// ]]-->
</script>
<!--#include virtual="/livedocs/ssi/globalheader.ssi" -->
        <link rel="stylesheet" type="text/css" href="tree.css" />
        <link rel="stylesheet" type="text/css" href="content-fonts.css" />
        <link rel="stylesheet" type="text/css" href="content-hyperlinks.css" />
        <link rel="stylesheet" type="text/css" href="content.css" />
        <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
    </head>
    <body id="content_body" onload="window.focus();">
        <a name="top"></a><div id="mnemonic">
            <div class="Dreamweaver"><table><tr><td class="banner">Dreamweaver CS4</td><td class="pod"><img src="images/PDF.gif" width="16" height="16" hspace="15" valign="50%" />&#160;&#160;
                     <a title="PDF" href="http://help.adobe.com/fr_FR/Dreamweaver/10.0_Using/dreamweaver_cs4_help.pdf">
                         PDF (adobe.com) 
                    </a></td></tr></table></div>
        </div>
        <div id="searchbar">
<!-- BEGIN SEARCH CONTENT -->
            <form class="search_form" id="search" name="search" action="search.html" target="_self">
                <img src="images/search.png" />
<script type="text/javascript">
<!--[CDATA[
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}
document.write('<input class=\"search_input\" \
        name=\"q\" \
        id=\"q\" \
        type=\"text\" \
        maxlength=\"256\" \
        value=\"' + terms_AHV_SEARCH_BUTTON + '\" onclick=\"clearSearch()\"><\/input>'); 
// ]]-->


</script> 
            </form>
        </div>
<!-- BEGIN PAGE CONTENT WRAPPER -->
        <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>
<td id="col1">
<!-- BEGIN IONCOMMENTCOUNT -->
            <div id="ionComCount">
            </div>
<!-- END IONCOMMENTCOUNT -->
<!-- BEGIN GROUP TOC WRAPPER -->
            <div id="group_toc"><p>Ressources de Dreamweaver CS4</p><ul><li><p><a href="../../Dreamweaver/10.0/index.html" target="_blank">Utilisation de Dreamweaver CS4</a></p>
</li><li><p><a href="http://help.adobe.com/fr_FR/Dreamweaver/10.0_Extending/index.html" target="_blank">Extension de Dreamweaver CS4 (adobe.com)</a></p>
</li><li><p><a href="http://help.adobe.com/fr_FR/Dreamweaver/10.0_API_Ref/index.html" target="_blank">Référence de l'API Dreamweaver (adobe.com)</a></p>
</li></ul></div>
<!-- END GROUP TOC WRAPPER -->
<!-- BEGIN NAV WRAPPER -->
            <div id="group_toc">
<script type="text/javascript">
<!--[CDATA[
if ( typeof(terms_BOOK_SHORT) != 'undefined' ) {
  document.write("<p>" + terms_BOOK_SHORT + "<\/p>");
}
// ]]-->


</script> 
            </div>
            <div id="nav_content">
            </div>
<!-- END NAV WRAPPER -->
</td>
<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->
            
            <div id="breadcrumb">
                
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WS3B1486C2-594E-4d56-9CBD-E5177B7A7767a.html" title="A propos des objets de commande ASP"><img src="images/blank.gif" alt="Précédent" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WScbb6b82af5544594822510a94ae8d65-78cea.html" title="A propos des procédures stockées"><img src="images/blank.gif" alt="Suivant" width="17" height="17" /></a></li></ul><div class="hierarchy"><a href="WScbb6b82af5544594822510a94ae8d65-78d3a.html">Création visuelle d'applications</a> /
     <a href="WScbb6b82af5544594822510a94ae8d65-788ca.html"><b>Création de pages avec objets de manipulation de données avancés (ColdFusion, ASP)</b></a> 
     </div>

            </div>
<!-- END BREADCRUMBS -->
            <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
                <h1>
                    Modification d'une base de données à l'aide des commandes ASP
                </h1>
<!-- END PAGE TITLE -->
                <div><div class="section"><p>A l'aide de Dreamweaver, vous pouvez créer des objets de commande ASP qui insèrent, mettent à jour et suppriment des enregistrements dans une base de données. Il vous suffit d'indiquer à l'objet de commande l'instruction ou la procédure stockée SQL qui effectue l'opération dans la base de données. </p>
</div>
<ol><li class="stepexpand"><span>Dans Dreamweaver, ouvrez la page ASP qui doit exécuter la commande.</span></li>
<li class="stepexpand"><span>Dans le panneau Comportements de serveur (Fenêtre &gt; Comportements de serveur), cliquez sur le bouton Plus&#160;(+), puis choisissez Commande. </span></li>
<li class="stepexpand"><span>Saisissez le nom de la commande, choisissez une connexion à&#160;une base de données contenant les enregistrements à modifier, puis sélectionnez l'opération de modification que la commande doit effectuer (Insérer, Mettre à jour ou Supprimer). </span> <p>Dreamweaver rédige le début de l'instruction SQL en fonction du type d'opération sélectionné. Par exemple, voici la boîte de dialogue qui s'affiche lorsque vous sélectionnez le type Insérer&#160;: </p>
<div class="fignone"><a href="#" onclick="return showHideImage('ba_cmdInsert', this);">Afficher le graphique à sa taille d'origine</a><img alt="" id="ba_cmdInsert" src="images/ba_cmdInsert.png" /><div class="figdesc"></div><br /></div></li>
<li class="stepexpand"><span>Complétez l'instruction SQL. </span> <p>Pour plus d'informations sur la rédaction d'instructions SQL modifiant des bases de données, consultez un manuel Transact-SQL.</p>
</li>
<li class="stepexpand"><span>Définissez les variables SQL dans la zone Variables. Fournissez le nom et la valeur d'exécution. La définition du type et de la taille de chaque variable empêche les attaques par injection.</span> <p>L'exemple ci-dessous illustre une instruction Insert qui contient trois variables SQL. Les valeurs de ces variables sont fournies par des paramètres d'URL transmis à la page, dont la définition s'affiche dans la colonne Valeur d'exécution de la zone Variables. </p>
<div class="fignone"><a href="#" onclick="return showHideImage('ba_cmdSQL', this);">Afficher le graphique à sa taille d'origine</a><img alt="" id="ba_cmdSQL" src="images/ba_cmdSQL.png" /><div class="figdesc"></div><br /></div><p>Pour obtenir la valeur de taille, utilisez le volet Bases de données de Dreamweaver. Dans le volet Bases de données, trouvez votre base de données et développez-la. Trouvez ensuite la table que vous utilisez et développez-la. La table contient les tailles de vos champs. Par exemple, elle peut indiquer ADDRESS (WChar 50). Dans cet exemple, la taille vaut 50. Vous pouvez également trouver la taille dans votre application de base de données.</p>
<div class="para"><div class="note"><span class="notetitle">Remarque&#160;:  </span>Les types de données Numérique, Booléen et date/heure emploient toujours la taille -1.</div>
</div>
<p>Pour déterminer la valeur Type, reportez-vous au tableau suivant&#160;:</p>
<div class="para">
<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d16e52288"><p>Type dans la base de données</p>
</th>
<th valign="top" width="NaN%" id="d16e52291"><p>Type dans Dreamweaver</p>
</th>
<th valign="top" width="NaN%" id="d16e52294"><p>Taille</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d16e52288 "><p>Numérique (MS Access, MS SQL Server, MySQL)</p>
</td>
<td valign="top" width="NaN%" headers="d16e52291 "><p>Double</p>
</td>
<td valign="top" width="NaN%" headers="d16e52294 "><p>-1</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e52288 "><p>Booléen, Oui/Non (MS Access, MS SQL Server, MySQL)</p>
</td>
<td valign="top" width="NaN%" headers="d16e52291 "><p>Double</p>
</td>
<td valign="top" width="NaN%" headers="d16e52294 "><p>-1</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e52288 "><p>Date/Heure (MS Access, MS SQL Server, MySQL)</p>
</td>
<td valign="top" width="NaN%" headers="d16e52291 "><p>DBTimeStamp</p>
</td>
<td valign="top" width="NaN%" headers="d16e52294 "><p>-1</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e52288 "><p>Tous les autres types de champ de texte, y compris les types de données texte MySQL char, varchar et longtext</p>
</td>
<td valign="top" width="NaN%" headers="d16e52291 "><p>LongVarChar</p>
</td>
<td valign="top" width="NaN%" headers="d16e52294 "><p>reportez-vous à la table de base de données</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e52288 "><p>Texte (MS Access) ou nvarchar, nchar (MS SQL Server)</p>
</td>
<td valign="top" width="NaN%" headers="d16e52291 "><p>VarWChar</p>
</td>
<td valign="top" width="NaN%" headers="d16e52294 "><p>reportez-vous à la table de base de données</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d16e52288 "><p>Mémo (MS Access), ntext (MS SQL Server), ou champs acceptant de grandes quantités de texte</p>
</td>
<td valign="top" width="NaN%" headers="d16e52291 "><p>LongVarWChar</p>
</td>
<td valign="top" width="NaN%" headers="d16e52294 "><p>1073741823</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Pour plus d'informations sur le type et la taille des variables SQL, consultez le site Web de Adobe à l'adresse <a href="http://www.adobe.com/go/4e6b330a_fr" target="_blank">www.adobe.com/go/4e6b330a_fr</a>. </p>
</li>
<li class="stepexpand"><span>Fermez la boîte de dialogue. </span> <p>Dreamweaver insère dans votre page un code ASP qui, lorsqu'il s'exécute sur le serveur, crée une commande qui insère, met à jour ou supprime des enregistrements dans la base de données.</p>
<p>Par défaut, la propriété Préparé de l'objet de commande est définie sur <samp class="codeph">true</samp>, ce qui permet au serveur d'application de réutiliser une seule version compilée de l'objet chaque fois que la commande est exécutée. Pour modifier ce paramètre, basculez en mode Code et définissez la propriété Préparé sur <samp class="codeph">false</samp>.</p>
</li>
<li class="stepexpand"><span>Créez une page avec un formulaire HTML, de manière à permettre aux utilisateurs d'entrer des données sur les enregistrements. Dans le formulaire HTML, ajoutez trois champs de texte (txtVille, txtAdresse et txtTéléphone) et un bouton Envoyer. Le formulaire utilise la méthode <samp class="codeph">GET</samp> et envoie les valeurs des champs de texte à la page contenant votre commande.</span></li>
</ol>
</div>

                <div id="related">
                    <div class="separator">&#160;</div>
                    
                    
                </div>
                <div id="footer">
                    <p><img src="images/Community.png" />&#160;<a title="Aide des communautés (adobe.fr)" href="http://www.adobe.com/go/lr_Dreamweaver_community_fr">Aide des communautés (adobe.fr)</a></p>
<!-- BEGIN IONCOMMENTS -->
                    <div id="ionComHere">
                    </div>
<!-- END IONCOMMENTS -->
<!--#include virtual="ionComments.ssi" -->
                    <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="Ce produit est distribué sous licence Creative Commons Paternité-Pas d'Utilisation Commerciale-Partage des Conditions Initiales à l'Identique 3.0 Unported" /></a></p>
                </div>
            </div>
<!-- END CONTENT WRAPPER -->
</td>
</tr>
</table>
        </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--#include virtual="/livedocs/ssi/globalfooter.ssi" -->
<!--#include virtual="/ubi/analytics/analytics_ssi.html" -->
    </body>
</html>