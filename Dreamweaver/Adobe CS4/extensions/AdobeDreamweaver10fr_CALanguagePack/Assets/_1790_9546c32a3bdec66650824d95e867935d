<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--#config errmsg="" --><!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="fr-fr">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <meta name="lang" content="fr-fr" />
        <meta name="area" content="livedocs" />
        <title>Dreamweaver CS4 * Création d'une connexion en utilisant une chaîne de connexion</title>
        <meta name="product" content="$product" />
        <meta name="productv" content="" />
        <meta name="keywords" content="" />
        <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc78c5058ca073340dcda9110b1f693f21-7a11.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> 
<script type="text/javascript">
<!--[CDATA[
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
    var linkId = document.createElement("link");
    linkId.href = "content-ie6.css";
    linkId.rel = "stylesheet";
    linkId.type = "text/css";
    headId.appendChild(linkId);
}
// ]]-->
</script>
<!--#include virtual="/livedocs/ssi/globalheader.ssi" -->
        <link rel="stylesheet" type="text/css" href="tree.css" />
        <link rel="stylesheet" type="text/css" href="content-fonts.css" />
        <link rel="stylesheet" type="text/css" href="content-hyperlinks.css" />
        <link rel="stylesheet" type="text/css" href="content.css" />
        <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
    </head>
    <body id="content_body" onload="window.focus();">
        <a name="top"></a><div id="mnemonic">
            <div class="Dreamweaver"><table><tr><td class="banner">Dreamweaver CS4</td><td class="pod"><img src="images/PDF.gif" width="16" height="16" hspace="15" valign="50%" />&#160;&#160;
                     <a title="PDF" href="http://help.adobe.com/fr_FR/Dreamweaver/10.0_Using/dreamweaver_cs4_help.pdf">
                         PDF (adobe.com) 
                    </a></td></tr></table></div>
        </div>
        <div id="searchbar">
<!-- BEGIN SEARCH CONTENT -->
            <form class="search_form" id="search" name="search" action="search.html" target="_self">
                <img src="images/search.png" />
<script type="text/javascript">
<!--[CDATA[
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}
document.write('<input class=\"search_input\" \
        name=\"q\" \
        id=\"q\" \
        type=\"text\" \
        maxlength=\"256\" \
        value=\"' + terms_AHV_SEARCH_BUTTON + '\" onclick=\"clearSearch()\"><\/input>'); 
// ]]-->


</script> 
            </form>
        </div>
<!-- BEGIN PAGE CONTENT WRAPPER -->
        <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>
<td id="col1">
<!-- BEGIN IONCOMMENTCOUNT -->
            <div id="ionComCount">
            </div>
<!-- END IONCOMMENTCOUNT -->
<!-- BEGIN GROUP TOC WRAPPER -->
            <div id="group_toc"><p>Ressources de Dreamweaver CS4</p><ul><li><p><a href="../../Dreamweaver/10.0/index.html" target="_blank">Utilisation de Dreamweaver CS4</a></p>
</li><li><p><a href="http://help.adobe.com/fr_FR/Dreamweaver/10.0_Extending/index.html" target="_blank">Extension de Dreamweaver CS4 (adobe.com)</a></p>
</li><li><p><a href="http://help.adobe.com/fr_FR/Dreamweaver/10.0_API_Ref/index.html" target="_blank">Référence de l'API Dreamweaver (adobe.com)</a></p>
</li></ul></div>
<!-- END GROUP TOC WRAPPER -->
<!-- BEGIN NAV WRAPPER -->
            <div id="group_toc">
<script type="text/javascript">
<!--[CDATA[
if ( typeof(terms_BOOK_SHORT) != 'undefined' ) {
  document.write("<p>" + terms_BOOK_SHORT + "<\/p>");
}
// ]]-->


</script> 
            </div>
            <div id="nav_content">
            </div>
<!-- END NAV WRAPPER -->
</td>
<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->
            
            <div id="breadcrumb">
                
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc78c5058ca073340dcda9110b1f693f21-7a0d.html" title="Création d'une connexion en utilisant un DSN distant"><img src="images/blank.gif" alt="Précédent" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc78c5058ca073340dcda9110b1f693f21-7a07.html" title="Modification ou suppression d'une connexion à une base de données"><img src="images/blank.gif" alt="Suivant" width="17" height="17" /></a></li></ul><div class="hierarchy"><a href="WSc78c5058ca073340dcda9110b1f693f21-7a31.html">Préparation à la création de sites dynamiques</a> /
     <a href="WSc78c5058ca073340dcda9110b1f693f21-7a11.html"><b>Connexions aux bases de données pour les développeurs ASP</b></a> 
     </div>

            </div>
<!-- END BREADCRUMBS -->
            <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
                <h1>
                    Création d'une connexion en utilisant une chaîne de connexion
                </h1>
<!-- END PAGE TITLE -->
                <br clear="both" /><div id="minitoc"><div class="t"><div class="b"><div class="l"><div class="r"><div class="bl"><div class="br"><div class="tl"><div class="tr"><div><h3>Sommaire [<a href="#" onclick="return toggleMiniToc('minitoc-links', this);" class="hideLink">Masquer</a>]</h3><ul id="minitoc-links"><li><p><a href="#WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E"><h4 class="topictitle4">Connexion à une base de données via un fournisseur d'accès</h4>
</a></p></li><li><p><a href="#WS134982D7-91C4-4831-926F-AA34ED294BF0"><h4 class="topictitle4">Description des chemins d'accès physiques et virtuels</h4>
</a></p></li><li><p><a href="#WS99AC032B-F852-490b-83F2-05E79C363F6B"><h4 class="topictitle4">Recherche du chemin d'accès physique d'un fichier en utilisant le chemin virtuel</h4>
</a></p></li><li><p><a href="#WSE46A9841-5A25-4bb1-9AAA-D480FB635D36"><h4 class="topictitle4">Utilisation d'un chemin d'accès virtuel pour établir une connexion à une base de données</h4>
</a></p></li></ul></div></div><br clear="both" /></div></div></div></div></div></div></div></div><br clear="both" /><div><div class="section"><p>Vous pouvez utiliser une connexion sans DSN pour créer une connexion ODBC ou OLE DB entre votre application Web et votre base de données. Il faut utiliser une chaîne de connexion pour créer ce type de connexion. </p>
</div>
<ol><li class="stepexpand"><span>Ouvrez une page ASP dans Dreamweaver, puis allez dans le panneau Bases de données (Fenêtre &#160;&gt;&#160; Bases de données).</span></li>
<li class="stepexpand"><span>Cliquez sur le bouton Plus (+) dans le panneau et sélectionnez Chaîne de connexion personnalisée dans le menu. Définissez les options, puis cliquez sur OK.</span></li>
<li class="stepexpand"><span>Entrez un nom pour la nouvelle connexion, sans espaces ni caractères spéciaux.</span></li>
<li class="stepexpand"><span>Tapez une chaîne de connexion vers la base de données. Si vous n'indiquez pas de fournisseur de BD OLE dans la chaîne de connexion, c'est-à-dire si vous ne saisissez pas de paramètre <samp class="codeph">Provider (Fournisseur)</samp>, ASP utilisera automatiquement le fournisseur de BD OLE pour les pilotes ODBC. Dans ce cas, vous devrez indiquer un pilote ODBC approprié pour votre base de données.</span> <p>Si votre site est hébergé par un fournisseur d'accès Internet et que vous ne connaissez pas le chemin d'accès complet à votre base de données, utilisez la méthode <samp class="codeph">MapPath</samp> de l'objet de serveur ASP dans votre chaîne de connexion.</p>
</li>
<li class="stepexpand"><span>Si le pilote de base de données spécifié dans la chaîne de connexion n'est pas installé sur le même ordinateur que Dreamweaver, sélectionnez Utilisation du pilote sur le serveur d'évaluation.</span> <div class="note"><span class="notetitle">Remarque&#160;:  </span>Les utilisateurs Macintosh peuvent ignorer cette étape car toutes les connexions aux bases de données utilisent le serveur d'application.</div>
</li>
<li class="stepexpand"><span>Vous pouvez limiter le nombre d'éléments de base de données récupérés par Dreamweaver au moment de la conception en cliquant sur Avancé puis en saisissant un nom de schéma ou de catalogue.</span> <div class="note"><span class="notetitle">Remarque&#160;:  </span>Vous ne pouvez pas créer de schéma ou de catalogue dans Microsoft Access.</div>
</li>
<li class="stepexpand"><span>Cliquez sur Tester pour vous connecter à la base de données, puis cliquez sur OK. Si la connexion n'aboutit pas, double-cliquez sur la chaîne de connexion ou vérifiez les paramètres du dossier d'évaluation utilisé par Dreamweaver pour traiter les pages dynamiques.</span></li>
</ol>
</div>
<div id="WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E" class="nochunk"><a name="WS2FEA1AD4-C0F4-4860-A229-276C5E06D18E"></a><h3 class="topictitle3">Connexion à une base de données via un fournisseur d'accès</h3><div><div class="section"><p>Si vous êtes un développeur ASP travaillant pour un fournisseur d'accès Internet, il est probable que vous ne connaissez pas le chemin physique d'accès aux fichiers que vous chargez, y compris celui de vos fichiers de base de données. </p>
<p>Si votre fournisseur d'accès ne définit pas de DSN pour vous ou ne le fait pas assez rapidement, vous devez trouver un autre moyen de créer des connexions à vos fichiers de base de données. Vous pouvez créer une connexion sans DSN à un fichier de base de données, mais une telle connexion n'est possible que si vous connaissez le chemin d'accès physique du fichier de base de données sur le serveur du fournisseur d'accès.</p>
<p>Vous pouvez obtenir le chemin d'accès physique à un fichier de base de données présent sur un serveur en utilisant la méthode <samp class="codeph">MapPath</samp> de l'objet serveur ASP.</p>
<div class="note"><span class="notetitle">Remarque&#160;:  </span>Les techniques présentées dans la présente section sont valables uniquement si votre base de données est basée sur un fichier, comme par exemple, une base de données Microsoft Access, qui stocke les données dans un fichier .mdb.</div>
</div>
</div></div>
<div id="WS134982D7-91C4-4831-926F-AA34ED294BF0" class="nochunk"><a name="WS134982D7-91C4-4831-926F-AA34ED294BF0"></a><h3 class="topictitle3">Description des chemins d'accès physiques et virtuels</h3><div><div class="section"><p>Lorsque vous chargez vos fichiers sur un serveur distant en utilisant Dreamweaver, ces derniers sont placés dans un dossier situé dans l'arborescence locale du serveur. Par exemple, sur un serveur exécutant Microsoft&#160;IIS, le chemin d'accès vers votre page d'accueil peut se présenter comme suit&#160;:</p>
<pre>c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm</pre>
<p>Il s'agit du chemin d'accès physique vers votre fichier. </p>
<p>En revanche, l'URL permettant d'ouvrir votre fichier n'utilise pas de chemin d'accès physique. Elle utilise le nom de serveur ou de domaine suivi d'un chemin d'accès virtuel, comme dans l'exemple suivant&#160;:</p>
<pre>www.plutoserve.com/jsmith/index.htm</pre>
<p>Le chemin d'accès virtuel, /jsmith/index.htm, remplace le chemin d'accès physique, c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm. </p>
</div>
</div></div>
<div id="WS99AC032B-F852-490b-83F2-05E79C363F6B" class="nochunk"><a name="WS99AC032B-F852-490b-83F2-05E79C363F6B"></a><h3 class="topictitle3">Recherche du chemin d'accès physique d'un fichier en utilisant le chemin virtuel</h3><div><div class="section"><p>Si vous travaillez avec un fournisseur d'accès, il se peut que vous ne connaissiez pas le chemin d'accès physique des fichiers que vous chargez. Généralement, les fournisseurs d'accès vous fournissent un hôte FTP, parfois un répertoire hôte, ainsi qu'un nom de connexion et un mot de passe. Ils vous indiquent également une URL pour visualiser vos pages sur Internet, telle que www.plutoserve.com/jsmith/.</p>
<p>Si vous connaissez cette URL, vous pouvez obtenir le chemin d'accès virtuel d'un fichier&#160;: il s'agit du chemin qui suit le nom du serveur ou du domaine qui figure dans une URL. Une fois que vous connaissez le chemin d'accès virtuel, vous pouvez obtenir le chemin d'accès physique à un fichier présent sur le serveur en utilisant la méthode <samp class="codeph">MapPath</samp>.</p>
<p>La méthode <samp class="codeph">MacPath</samp> utilise le chemin d'accès virtuel comme argument et renvoie le chemin d'accès physique et le nom du fichier. Voici la syntaxe de la méthode&#160;:</p>
<pre>Server.MapPath("<var class="varname">/virtualpath</var>")</pre>
<p>Si le chemin virtuel d'un fichier est /jsmith/index.htm, l'expression suivante permet d'obtenir son chemin d'accès physique&#160;:</p>
<pre>Server.MapPath("/jsmith/index.htm")</pre>
<p>Vous pouvez utiliser la méthode <samp class="codeph">MacPath</samp> comme suit. </p>
</div>
<ol><li class="stepexpand"><span>Ouvrez une page ASP dans Dreamweaver et basculez en mode Code (Affichage&#160;&gt; Code).</span></li>
<li class="stepexpand"><span>Saisissez l'expression suivante dans le code HTML de la page.</span> <pre>&lt;%Response.Write(<var class="varname">stringvariable</var>)%&gt;</pre>
</li>
<li class="stepexpand"><span>Utilisez la méthode <samp class="codeph">MapPath</samp> afin d'obtenir une valeur pour l'argument <samp class="codeph"><var class="varname">stringvariable</var></samp>. </span> <p>Exemple&#160;:</p>
<pre>&lt;% Response.Write(Server.MapPath("/jsmith/index.htm")) %&gt;</pre>
</li>
<li class="stepexpand"><span>Basculez en mode Création (Affichage&#160;&gt; Création) et activez le mode Données dynamiques (Affichage&#160;&gt; Données dynamiques) pour afficher la page.</span> <p>La page affiche le chemin physique du fichier sur le serveur d'application, par exemple&#160;:</p>
<pre>c:\Inetpub\wwwroot\accounts\users\jsmith\index.htm</pre>
<p>Pour plus d'informations sur la méthode <samp class="codeph">MapPath</samp>, consultez la documentation en ligne disponible avec Microsoft&#160;IIS. </p>
</li>
</ol>
</div></div>
<div id="WSE46A9841-5A25-4bb1-9AAA-D480FB635D36" class="nochunk"><a name="WSE46A9841-5A25-4bb1-9AAA-D480FB635D36"></a><h3 class="topictitle3">Utilisation d'un chemin d'accès virtuel pour établir une connexion à une base de données</h3><div><div class="section"><p>Pour écrire une chaîne de connexion sans DSN dans un fichier de base de données situé sur un serveur distant, vous devez connaître le chemin d'accès physique au fichier. Par exemple, voici une chaîne de connexion sans DSN typique pour une base de données Microsoft Access&#160;:</p>
<pre>Driver={Microsoft Access Driver (*.mdb)}; 
DBQ=c:\Inetpub\wwwroot\accounts\users\jsmith\data\statistics.mdb</pre>
<p>Si vous ne connaissez pas le chemin d'accès physique à vos fichiers sur le serveur distant, vous pouvez l'obtenir en utilisant la méthode <samp class="codeph">MapPath</samp> dans votre chaîne de connexion.</p>
</div>
<ol><li class="stepexpand"><span>Chargez le fichier de base de données le fichier de base de données sur le serveur distant et notez son chemin d'accès virtuel (par exemple, /jsmith/data/statistics.mdb).</span></li>
<li class="stepexpand"><span>Ouvrez une page ASP dans Dreamweaver, puis ouvrez le panneau Bases de données (Fenêtre&#160;&gt; Bases de données).</span></li>
<li class="stepexpand"><span>Cliquez sur le bouton Plus (+) dans le panneau et sélectionnez Chaîne de connexion personnalisée dans le menu.</span></li>
<li class="stepexpand"><span>Entrez un nom pour la nouvelle connexion, sans espaces ni caractères spéciaux.</span></li>
<li class="stepexpand"><span>Tapez la chaîne de connexion et utilisez la méthode <samp class="codeph">MapPath</samp> pour fournir le paramètre DBQ.</span> <p>Supposons que le chemin virtuel vers votre base de données Microsoft Access soit /jsmith/data/statistics.mdb. La chaîne de connexion peut être exprimée comme suit si vous utilisez VBScript comme langage de script :</p>
<pre>"Driver={Microsoft Access Driver (*.mdb)};DBQ=" &amp; Server.MapPath¬ 
("/jsmith/data/statistics.mdb")</pre>
<p>L'esperluette (&amp;) est utilisée pour concaténer (combiner) deux chaînes. La première chaîne est entre guillemets et la deuxième est fournie par l'expression <samp class="codeph">Server.MapPath</samp>. Lorsque les deux chaînes sont combinées, la chaîne suivante est créée&#160;:</p>
<pre>Driver={Microsoft Access Driver (*.mdb)}; 
DBQ=C:\Inetpub\wwwroot\accounts\users\jsmith\data\statistics.mdb</pre>
<p>Si vous utilisez JavaScript, l'expression est quasiment identique&#160;; la seule différence réside dans l'utilisation d'un signe plus (+) au lieu d'une esperluette (&amp;) pour concaténer les deux chaînes&#160;:</p>
<pre>"Driver={Microsoft Access Driver (*.mdb)};DBQ=" + Server.MapPath¬ 
("/jsmith/data/statistics.mdb")</pre>
</li>
<li class="stepexpand"><span>Sélectionnez Utilisation du pilote sur le serveur d'évaluation, cliquez sur Tester, puis cliquez sur OK.</span> <div class="note"><span class="notetitle">Remarque&#160;:  </span>Les utilisateurs Macintosh peuvent ignorer cette étape car toutes les connexions aux bases de données utilisent le serveur d'application.</div>
 <div class="note"><span class="notetitle">Remarque&#160;:  </span>Si la connexion n'échoue, cliquez deux fois sur la chaîne de connexion ou contactez votre fournisseur d'accès pour vous assurer que le pilote de base de données que vous avez spécifié dans la chaîne de connexion est installé sur le serveur distant. Vérifiez également que le fournisseur d'accès dispose de la version la plus récente du pilote. Par exemple, une base de données créée dans Microsoft Access&#160;2000 ne fonctionnera pas avec Microsoft Access Driver&#160;3.5. Vous devez utiliser Microsoft Access Driver, version&#160;4.0 ou ultérieure.</div>
</li>
<li class="stepexpand"><span>Mettez à jour la connexion de base de données des pages dynamiques existantes (ouvrez la page dans Dreamweaver, double-cliquez sur le nom du jeu d'enregistrements dans le panneau Liaisons ou Comportements de serveur, et sélectionnez la connexion que vous venez de créer dans le menu Connexion), et utilisez la nouvelle connexion avec toutes les nouvelles pages que vous créerez. </span></li>
</ol>
</div></div>

                <div id="related">
                    <div class="separator">&#160;</div>
                    <div><p><a href="WSc78c5058ca073340dcda9110b1f693f21-7a20.html">Connexion à une base de données ColdFusion</a></p><p><a href="WSc78c5058ca073340dcda9110b1f693f21-79b9a.html">Limitation des informations de base de données affichées dans Dreamweaver</a></p><p><a href="WSc78c5058ca073340dcda9110b1f693f21-79f1.html">Résolution des problèmes de connexion aux bases de données</a></p>
</div>
                    
                </div>
                <div id="footer">
                    <p><img src="images/Community.png" />&#160;<a title="Aide des communautés (adobe.fr)" href="http://www.adobe.com/go/lr_Dreamweaver_community_fr">Aide des communautés (adobe.fr)</a></p>
<!-- BEGIN IONCOMMENTS -->
                    <div id="ionComHere">
                    </div>
<!-- END IONCOMMENTS -->
<!--#include virtual="ionComments.ssi" -->
                    <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="Ce produit est distribué sous licence Creative Commons Paternité-Pas d'Utilisation Commerciale-Partage des Conditions Initiales à l'Identique 3.0 Unported" /></a></p>
                </div>
            </div>
<!-- END CONTENT WRAPPER -->
</td>
</tr>
</table>
        </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--#include virtual="/livedocs/ssi/globalfooter.ssi" -->
<!--#include virtual="/ubi/analytics/analytics_ssi.html" -->
    </body>
</html>